%% -*- coding:utf-8 -*- 
\section{Квантовое состояние электромагнитного поля с определенной
  энергией (с определенным числом фотонов)}
Сначала рассмотрим одну моду электромагнитного поля (простой
гармонический осциллятор). Вектор состояния с определенной энергией
$\ket{E_n}$ удовлетворяет следующему уравнению
\begin{equation}
\hat{\mathcal{H}} \ket{E_n} = E_n \ket{E_n}
\end{equation}
Здесь и далее будем пользоваться формализмом Дирака (см. 
\autoref{AddDirac}). Используя соотношение \eqref{eqCh1_mainpropertyaa},
получим 
\begin{equation}
\hat{\mathcal{H}} \hat{a}\ket{E_n} = 
\left(\hat{a}\hat{\mathcal{H}} -
\hbar\omega\hat{a}\right)\ket{E_n} =
\left(E_n - \hbar \omega\right)\hat{a}\ket{E_n}
\end{equation}
т. е. $\hat{a}\ket{E_n}$ также является вектором состояния с
энергией $E_n - \hbar \omega$.  Отсюда следует, что
\[
\hat{a}\ket{E_n} = \left|E_n - \hbar \omega \right>
\] 
Следовательно, оператор $\hat{a}$ понижает энергию состояния на $\hbar
\omega$,  где $\omega$ - частота моды (осциллятора). Часто $\hat{a}$
называют понижающим оператором, или оператором уничтожения. Наименьшая
энергия должна быть положительной, и понижение энергии не может
продолжаться неограниченно. Для произвольного вектора состояния
ожидаемое значение энергии 
\begin{equation}
\left< \Phi \right| \hbar \omega \left({a}^{\dag} {a}  +
\frac{1}{2}\right)\left| \Phi \right> = 
\hbar \omega \left< \Phi' \right. \left| \Phi' \right> + \frac{1}{2}
\hbar \omega,
\end{equation}
где  $\hat{a} \left| \Phi \right> = \left| \Phi' \right>$,  
$\left< \Phi \right| \hat{a}^{\dag}  = \left< \Phi' \right|$.  Поскольку
норма вектора состояния должна быть положительной, 
наименьшее значение энергии будет при  
\(
\left< \Phi' \right. \left| \Phi' \right> = 0.
\)
Это означает, что $\hat{a}\ket{0} = 0$,  где
$\left|\Phi\right> = \ket{0}$ -  вектор состояния с наименьшей
энергией. Наименьшая энергия  
\begin{equation}
E_0 = \frac{\hbar \omega}{2}
\end{equation}
называется энергией нулевых колебаний. Для проверки этого утверждения
можно написать
\begin{eqnarray}
\hat{\mathcal{H}} \ket{0} = 
\hbar \omega \left(\hat{a}^{\dag} \hat{a} +
\frac{1}{2}\right) \ket{0} = 
\nonumber \\
= 
\hbar \omega \hat{a}^{\dag} \hat{a} \ket{0} +
\frac{\hbar \omega}{2}\ket{0} =
\nonumber \\
= \frac{\hbar \omega}{2} \ket{0} = 
E_0 \ket{0}.
\label{eqProper0state}
\end{eqnarray}


С помощью \eqref{eqCh1_mainpropertyaa} можно получить
\begin{eqnarray}
\hat{\mathcal{H}} \hat{a}^{\dag}\ket{0} = 
\hat{\mathcal{H}} \ket{1} =
\left(\hat{a}^{\dag} \hat{\mathcal{H}} + \hbar \omega \hat{a}^{\dag} \right)
\ket{0} = 
\nonumber \\
= \hbar \omega \left(1 + \frac{1}{2}\right)
\hat{a}^{\dag} \ket{0} = 
\hbar \omega \left(1 + \frac{1}{2}\right)
\ket{1}
\end{eqnarray}
где через $\ket{1} = \hat{a}^{\dag} \ket{0}$ обозначено
состояние с энергией $\hbar \omega \left(1 + \frac{1}{2}\right)$.

По индукции имеем
\begin{equation}
\hat{\mathcal{H}} \left(\hat{a}^{\dag}\right)^n\ket{0} = 
\hat{\mathcal{H}} \ket{n} 
= \hbar \omega \left(n + \frac{1}{2}\right)
\left(\hat{a}^{\dag}\right)^n\ket{0} = 
\hbar \omega \left(n + \frac{1}{2}\right)
\ket{n}
\label{eqCh1_aplusinduction}
\end{equation}
где
$\ket{n} = \left(\hat{a}^{\dag}\right)^n\ket{0}$   
без нормировки, которую проведем далее -  состояние с энергией  
$\hbar \omega \left(n + \frac{1}{2}\right)$,  $n$  -  целое
положительное число.

Видим, что оператор  $\hat{a}^{\dag}$  повышает энергию состояния на
$\hbar \omega$.  Его можно рассматривать как оператор рождения частицы
- фотона \rindex{фотон} с энергией  $\hbar \omega$.  О фотоне как о частице лучше
говорить в случае разложения поля по плоским волнам. Тогда это будет
частица с энергией $\hbar \omega$ и импульсом $\hbar \vec{k}$,  как
это следует из \eqref{eqCh1_task3_2}. 
  
Соотношения 
$\hat{a} \ket{n} = \ket{n - 1}$
и
$\hat{a}^{\dag} \ket{n} = \ket{n + 1}$
определяют ненормированные векторы состояния. Определим нормирующий
множитель. Предположим, что  
$\hat{a} \ket{n} = S_n \ket{n - 1}$,  где 
$\ket{n}$ и $\ket{n - 1}$ нормированы к  1,  а $S_n$
является нормирующим множителем. Отсюда получим 
\[
S_n^2\bra{n - 1}\ket{n - 1} =
\bra{n}\hat{a}^{\dag}\hat{a}\ket{n} = 
n  \bra{n}\ket{n}
\]
т.к. оператор    
$\hat{a}^{\dag}\hat{a} = \hat{n}$
является оператором числа фотонов, собственным числом
которого является число фотонов. Это видно из формулы
\eqref{eqCh1_aplusinduction}. Действительно, из равенства
\[
\hat{\mathcal{H}} \ket{n} =
\hbar \omega \left(
\hat{a}^{\dag}\hat{a} + \frac{1}{2}
\right)
\ket{n} = 
\hbar \omega \left(n + \frac{1}{2}\right)
\ket{n},
\]
получаем:
\[
\hat{n}\ket{n} = \hat{a}^{\dag}\hat{a} \ket{n} = n
\ket{n}. 
\]
Из условия нормировки следует: $\bra{n}\ket{n} = 1$   и
$S_n^2 = n$,  откуда $S_n = \sqrt{n}$ и, следовательно, имеем: 
\begin{equation}
\hat{a}\ket{n} = \sqrt{n}\ket{n - 1}
\end{equation}
По аналогии, с помощью коммутационных соотношений
\eqref{eqCh1_aacomutation}, а также \ref{eqAddDirac_operator_property1} и
  \ref{eqAddDirac_operator_property2} из \autoref{AddDirac},
  получаем 
\begin{eqnarray}
\hat{a}^{\dag}\ket{n} = S_{n+1}\ket{n + 1},
\quad 
\bra{n}\hat{a} = S_{n + 1}\bra{n + 1},
\nonumber \\
\bra{n}\hat{a}\hat{a}^{\dag}\ket{n} = S_{n+1}^2
\bra{n + 1}\ket{n + 1} = 
\bra{n}\hat{a}^{\dag}\hat{a} + 1\ket{n} = 
\left(n + 1\right)\bra{n}\ket{n},
\nonumber \\
S_{n+1}^2 = n + 1.
\end{eqnarray}
Следовательно, имеем равенство
\begin{equation}
\hat{a}^{\dag}\ket{n} = \sqrt{n + 1}\ket{n + 1},
\end{equation}

Собственные состояния оператора числа фотонов $\hat{n}$ являются ортонормированными. 
Действительно из того факта что оператор $\hat{n}$ является эрмитовым:
\[
\hat{n}^{\dag} = \left(\hat{a}^{\dag}\hat{a}\right)^{\dag} = 
\hat{a}^{\dag} \left(\hat{a}^{\dag}\right)^{\dag} = 
\hat{a}^{\dag}\hat{a} = \hat{n}
\]
следует (см. \autoref{AddDirac}), что собственные функции этого оператора,
соответствующие разным собственным числам, ортогональны, т. е.
\begin{equation}
\bra{n}\ket{n'} = 0, \mbox{ если } n \ne n'.
\label{eqOrtoN}
\end{equation}

Дадим сводку соотношений, в которые входят операторы $\hat{a}$ и $\hat{a}^{\dag}$:
\begin{eqnarray}
\hat{\mathcal{H}} = \hbar \omega \left(\hat{a}^{\dag}\hat{a} +
\frac{1}{2} \right),
\quad
\hat{a}\ket{0} = 0,
\quad
\hat{a}^{\dag}\hat{a}\ket{n} = \hat{n}\ket{n},
\nonumber \\
\left[\hat{a}, \hat{a}^{\dag}\right] = \hat{a} \hat{a}^{\dag} - \hat{a}^{\dag}
\hat{a} = 1,
\quad
\hat{a}\ket{n} = \sqrt{n}\ket{n - 1}
\nonumber \\
\hat{\mathcal{H}}\ket{n} = \hbar \omega \left(\hat{a}^{\dag}\hat{a} +
\frac{1}{2} \right)\ket{n},
\nonumber \\
\hat{a}^{\dag}\ket{n} = \sqrt{n + 1}\ket{n + 1},
\quad
\ket{n} = \frac{1}{\sqrt{n!}}\left(\hat{a}^{\dag}\right)^n\ket{0}
\end{eqnarray}
и сопряженные равенства
\begin{eqnarray}
\bra{0}\hat{a}^{\dag} = 0,
\quad
\bra{n}\hat{a} = \sqrt{n + 1}\bra{n + 1}
\nonumber \\
\bra{n}\hat{a}^{\dag} = \sqrt{n}\bra{n - 1},
\quad
\bra{n} =  \frac{1}{\sqrt{n!}} \bra{0}\left(\hat{a}^{\dag}\right)^n.
\end{eqnarray}

Для простейшей модели резонатора имеем
\[
\hat{E}\left(z, t\right) = E_1\left( \hat{a} +
\hat{a}^{\dag}\right) \sin k_n z
\]
где $E_1 = \sqrt{\frac{\hbar \omega}{\varepsilon_0 V}}$  поле,
соответствующее одному фотону в моде.  

Рассмотрим некоторые свойства энергетических состояний, т.е. состояний
с определенным числом фотонов. Покажем, что среднее значение
электрического поля в этом состоянии равно нулю: 
\begin{eqnarray}
\bra{n}\hat{E}\ket{n} = 
E_1 \sin k_n z \left( \bra{n}\hat{a}\ket{n} +
\bra{n}\hat{a}^{\dag}\ket{n}\right) =
\nonumber \\
= E_1 \sin k_n z \left( \bra{n}\ket{n - 1} \sqrt{n} +
\bra{n}\ket{n + 1} \sqrt{n + 1}
\right) = 0
\label{eqCh1_E_middle}
\end{eqnarray}
что следует из ортогональности состояний \eqref{eqOrtoN}
$\bra{n}\ket{n'} = 0$.

Среднее значение оператора квадрата электрического поля отлично от нуля:
\begin{eqnarray}
\bra{n}\hat{E}^2\ket{n} = 
E_1^2 \sin^2 k_n z \bra{n}
\left(
\hat{a}^{\dag} \hat{a}^{\dag} + \hat{a} \hat{a}^{\dag} + \hat{a}^{\dag} \hat{a} +
\hat{a} \hat{a}
\right)
\ket{n} =
\nonumber \\
= 2 E_1^2 \sin^2 k_n z \left( n + \frac{1}{2}
\right).
\label{eqCh1_E2_middle}
\end{eqnarray}

Обычно рассматриваемые в квантовой оптике поля не находятся в
стационарном состоянии с определенной энергией (с определенным числом
фотонов). Однако произвольное состояние можно представить как
суперпозицию состояний $\ket{n}$ : 
\begin{equation}
\left|\psi\right> = \sum_{(n)} C_n \ket{n}
\end{equation}
где $\left|C_n\right|^2$ - вероятность при измерении обнаружить в моде
$n$ фотонов; $\sum_{(n)} \left|C_n\right|^2 = 1$. 
В \autoref{AddDirac} показано, что
\[
C_n = \bra{ n }\left| \psi \right>, \quad
\left| \psi \right> = \sum_{(n)} \bra{ n }\left| \psi \right>
\ket{ n } =
\sum_{(n)} \ket{ n }\bra{ n }\left| \psi \right>,
\quad
\sum_{(n)} \ket{ n }\bra{ n } = \hat{I},
\]
где $\hat{I}$ - единичный оператор.

\begin{remark}[О состояниях с определенной энергией в квантовой
    механике]
  Стоит отметить, что состояния с определенной энергией не нарушают 
  соотношение неопределенности Гейзенберга для пары
  энергия - время
  \[
  \Delta E \Delta t \ge \frac{\hbar}{2},
  \]
  (более подробно
  см. \autoref{AddHeisenbergUncertaintyPrincipleEnergyTime}). 

  Вместе с тем, если посмотреть на оператор энергии гармонического
  осциллятора, записанный в виде
  \[
  \hat{\mathcal{H}} =\frac{1}{2} \left(\hat{p}^2 +
  \omega^2\hat{q}^2\right)
  \]
  и воспользоваться выражениями \eqref{eqCh1_qpdef}, то можно получить,
  что $\bra{n}\hat{q}\ket{n} =
  \bra{n}\hat{p}\ket{n} = 0$. Вместе с тем
  \begin{eqnarray}
    \bra{n}\hat{q}^2\ket{n} = \frac{\hbar}{2 \omega}
    \left[
      \bra{n}\hat{a}^2\ket{n} +
      \bra{n}\left(\hat{a}^{\dag}\right)^2\ket{n} +
      \right.
      \nonumber \\
      \left.
      +
      \bra{n}\hat{a}^{\dag}\hat{a}\ket{n} +
      \bra{n}\hat{a}\hat{a}^{\dag}\ket{n}
      \right] =
    \nonumber \\
    = \frac{\hbar}{2 \omega}
    \left[n + n + 1\right],
    \nonumber
  \end{eqnarray}
  a также
  \begin{eqnarray}
    \bra{n}\hat{p}^2\ket{n} = - \frac{\hbar \omega}{2}
    \left[
      \bra{n}\hat{a}^2\ket{n} +
      \bra{n}\left(\hat{a}^{\dag}\right)^2\ket{n} - \right.
      \nonumber \\
      \left.
      -
      \bra{n}\hat{a}^{\dag}\hat{a}\ket{n} -
      \bra{n}\hat{a}\hat{a}^{\dag}\ket{n}
      \right] =
    \nonumber \\
    = \frac{\hbar \omega}{2}
    \left[n + n + 1\right].
    \nonumber
  \end{eqnarray}
  Т. о.
  \[
  \Delta p = \sqrt{\bra{n}\hat{p}^2\ket{n} -
    \bra{n}\hat{p}\ket{n}^2} =
  \sqrt{\frac{\hbar \omega}{2}\left(2n + 1\right)}
  \]
  и
  \[
  \Delta q = \sqrt{\bra{n}\hat{q}^2\ket{n} -
    \bra{n}\hat{q}\ket{n}^2} =
  \sqrt{\frac{\hbar}{2\omega}\left(2n + 1\right)}
  \]
  или
  \[
  \Delta p \Delta q = \frac{\hbar}{2}\left(2n + 1\right) \ge \frac{\hbar}{2},
  \]
  что находится в соответствии с соотношениями неопределенности
  Гейзенберга \eqref{eqAddHeisenbergUncertaintyPrinciple}.

  Таким образом состояния с определенной энергией это такие состояния,
  в которых несмотря на невозможность определить без погрешностей $p$
  и $q$ имеется возможность определения величины 
  \(
  \frac{1}{2} \left(p^2 +
  \omega^2q^2\right)
  \). Это отражает тот факт, что для квантовых систем возможны
  ситуации при которых существуют составные события при отсутствии
  элементарных (см. \autoref{sec:add:quantprobability}). 
  И, в частности, такая ситуация имеет место для фотона
  - состояния с определенной энергией $\ket{1}$.

  Это может привести нас к рассуждению о том, что фотон это
  виртуальная частица, которая отсутствует в реальном физическом мире
  \cite{Lamb1995}.\rindex{фотон} Вместе с тем математический аппарат связанный с
  понятием фотона как то, операторы рождения $\hat{a}^\dag$ и
  уничтожения $\hat{a}$, состояния электромагнитного поля с
  определенной энергией $\{\ket{n}\}$ (которые могут быть
  использованы в качестве базисных состояний), представляется удобным
  для теоретического описания.

  Стоит так же отметить, что с точки зрения формального определения
  неклассического состояния \eqref{eqPart3_Nonclass_Nonclass7},
  $\ket{n}$ является неклассическим 
  состоянием света поскольку из \eqref{eqCh4_26} следует $G^{(2)} <
  1$.

  С другой стороны, если посмотреть на минимально возможную энергию
  моды электромагнитного поля то из соотношения
  \eqref{eqCh1_hamilton_one_mode} 
  \[
  \mathcal{H} = \frac{1}{2}\left(\omega^2 q^2 + p^2\right)
  \]
  следует, что в классическом случае минимально возможная нулевая
  энергия достигается при $p = 0, q=0$, но в силу
  \eqref{eqAddHeisenbergUncertaintyPrinciple} нулевые значения
  невозможны в квантовом случае, а с учетом неопределенности измерений
  получим 
  \begin{eqnarray}
    \frac{1}{2}\left(\omega^2 (\Delta q)^2 + (\Delta p)^2\right) \ge
    \nonumber \\
    \ge \omega \Delta q \Delta p \ge \frac{\hbar \omega}{2}
    \nonumber
  \end{eqnarray}
  то есть минимально возможная энергия (энергия вакуума) определяется
  неравенствами Гейзенберга для пары координата - импульс.  
  \label{rem:antiphoton}
\end{remark}
