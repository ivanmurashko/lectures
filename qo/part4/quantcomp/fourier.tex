%% -*- coding:utf-8 -*- 
\section{Квантовое преобразование Фурье}
Для анализа периодических последовательностей (функций) может быть
использовано дискретное преобразование Фурье
(см. \autoref{AddFourier}), которое определяется следующим соотношением
\eqref{eqAddFourierDiscretFourier}:
\begin{equation}
\tilde{X}_k = \sum^{M - 1}_{m = 0} x_m e^{-\frac{2 \pi}{M} k\cdot m},
\label{eqPart4QuantCompShorFourierDiscretFourier}
\end{equation}
где исходная последовательность чисел $\left\{x_m\right\}$ имеет $M$
членов. 

\subsection{Схема квантового преобразования Фурье}
Квантовое преобразование Фурье
\footnote{Для анализа работы схемы квантового преобразования Фурье
  была использована работа \cite{DBLP:conf/new2an/2015}}
имеет дело с состояниями вида 
\begin{equation}
\ket{x} = \sum_{k = 0}^{M - 1}x_k \ket{k},
\label{eqPart4QuantCompShorQuantFourierSeries}
\end{equation}
где имеется последовательнеость амплитуд $\left\{x_k\right\}$, которая
задает исходную последовательность для преобразования Фурье 
\eqref{eqPart4QuantCompShorFourierDiscretFourier}. В базисном векторе
$\ket{k}$ записан номер члена этой последовательности.   

Очевидно, что члены последовательности
\eqref{eqPart4QuantCompShorQuantFourierSeries}  должны удовлетворять
условию нормировки 
\[
\sum_k\left|x_k\right|^2 = 1.
\]

Допустим что некоторый оператор $\hat{F}^{M}$ (оператор квантового
преобразования Фурье) преобразует базисный вектор $\ket{k}$ по
правилу задаваемому соотношением \eqref{eqAddFourierDiscretFourier}:
\begin{equation}
\hat{F}^{M}\ket{k} = \frac{1}{\sqrt{M}}\sum_{j = 0}^{M -1}
e^{-i \omega k j}\ket{j}_{inv} 
\label{eqPart4QuantCompShorQuantFourierBasis}
\end{equation}
Системы базисных векторов $\left\{\ket{k}\right\}$ и 
$\left\{\ket{k}_{inv}\right\}$ представляют собой один и тот же
набор векторов которые пронумерованны различным способом.

Из \eqref{eqPart4QuantCompShorQuantFourierSeries} и
\eqref{eqPart4QuantCompShorQuantFourierBasis} получим
\begin{eqnarray}
\hat{F}^{M}\ket{x} = \sum_{j = 0}^{M - 1}x_k \hat{F}^{M}
\ket{k} = 
\nonumber \\
= \frac{1}{\sqrt{M}}\sum_{k = 0}^{M -1}\sum_{j = 0}^{M - 1}
e^{-i \omega k j}x_k\ket{j}_{inv} = 
\nonumber \\
= \sum_{j = 0}^{M - 1} \left\{\frac{1}{\sqrt{M}}\left(
\sum_{k = 0}^{M - 1}e^{-i \omega k j} x_k
\right)\right\}\ket{j}_{inv} = 
\nonumber \\
= \sum_{j = 0}^{M - 1}\tilde{X}_j\ket{j}_{inv} = \left|\tilde{X}\right>_{inv},
\nonumber
\end{eqnarray}
где 
\begin{equation}
\tilde{X}_j = \tilde{X}_j^{M} = 
\frac{1}{\sqrt{M}}\sum_{k = 0}^{M - 1}e^{-i \omega k j} x_k.
\label{eqPart4QuantCompShorQuantFourierEnd}
\end{equation}
Выражение \eqref{eqPart4QuantCompShorQuantFourierEnd} повторяет
классический аналог \eqref{eqAddFourierDiscretFourier}, т. е. можно записать
\[
 \ket{x} \longleftrightarrow \left|\tilde{X}\right>_{inv}.
\]

\input ./part4/quantcomp/figquantfourier0.tex

Допустим теперь, что на вход нашей системы подается состояние вида
\eqref{eqPart4QuantCompShorQuantFourierSeries} которое представляет
собой суперпозицию $M$ базисных состояний
$\left\{\ket{k}\right\}$ 
(см. \autoref{figQuantCompQuantFourier0}). 
Предположим что число базисных
состояний является степенью двойки, т. е. базисное состояние
представимо в виде тензорного произведения $n = \log_2{M}$ кубитов:
\begin{equation}
\ket{k} = \ket{a^{(k)}_0} \otimes  \ket{a^{(k)}_1}
\otimes \cdots \otimes \ket{a^{(k)}_{n-1}}, 
\nonumber
\end{equation}
где
\begin{eqnarray}
k = a^{(k)}_0 + 2^1 a^{(k)}_1 + \dots + 2^{n-1} a^{(k)}_{n-1},
\nonumber \\
a^{(k)}_i \in \left\{0, 1\right\}.
\nonumber
\end{eqnarray}

На выходе
(см. \autoref{figQuantCompQuantFourier0})
мы имеем суперпозицию $M$ базисных состояний
$\left\{\ket{j}_{inv}\right\}$, где для состояния
$\ket{j}_{inv}$ получим 
\begin{equation}
\ket{j}_{inv} = \ket{b^{(j)}_{n-1}} \otimes
\ket{b^{(j)}_{n-2}} 
\otimes \cdots \otimes \ket{b^{(j)}_{0}}, 
\nonumber
\end{equation}
где
\begin{eqnarray}
j = b^{(j)}_0 + 2^1 b^{(j)}_1 + \dots + 2^{n-1} b^{(j)}_{n-1},
\nonumber \\
b^{(j)}_i \in \left\{0, 1\right\}.
\nonumber
\end{eqnarray}

Из формулы \eqref{eqAddFourierDiscretFourierFFT} можно
заметить, что если у нас имеется входной сигнал $x$ состоящий из $n =
\log_2{M}$ 
битов, то бит $a^{(k)}_0$ может быть использован для выбора четных
(первого члена суммы \eqref{eqAddFourierDiscretFourierFFT})
или нечетных 
(второго члена суммы \eqref{eqAddFourierDiscretFourierFFT}).

Действительно, исключая $a^{(k)}_0$, состояние
\eqref{eqPart4QuantCompShorQuantFourierSeries} можно представить в
виде суммы четных и нечетных компонент: 
\begin{eqnarray}
\ket{x} = \sum_{k = 0}^{M - 1}x_k \ket{k} = 
\sum_{k = 0}^{M - 1}x_k \ket{a^{(k)}_0} \otimes  \ket{a^{(k)}_1}
\otimes \cdots \otimes \ket{a^{(k)}_{n-1}} = 
\nonumber \\
 = \sum_{m = 0}^{\frac{M}{2} - 1}x_{k=2m} \ket{0} \otimes  \ket{a^{(k)}_1}
\otimes \cdots \otimes \ket{a^{(k)}_{n-1}} +
\nonumber \\
+
\sum_{m = 0}^{\frac{M}{2} - 1}x_{k=2m + 1} \ket{1} \otimes  \ket{a^{(k)}_1}
\otimes \cdots \otimes \ket{a^{(k)}_{n-1}} = 
\nonumber \\
 = \sum_{m = 0}^{\frac{M}{2} - 1}x_{k=2m} \ket{0} \otimes  \ket{m} +
\sum_{m = 0}^{\frac{M}{2} - 1}x_{k=2m + 1} \ket{1} \otimes  \ket{m} = 
\nonumber \\
= \sum_{m = 0}^{\frac{M}{2} - 1}x_{2m} \ket{2m} +
\sum_{m = 0}^{\frac{M}{2} - 1}x_{2m + 1} \ket{2m+1},
\nonumber
\end{eqnarray}
где
\begin{equation}
m = a^{(k)}_1 + 2^1 a^{(k)}_2 + \dots + 2^{n-2} a^{(k)}_{n-1}.
\nonumber
\end{equation}

\input ./part4/quantcomp/figquantfourier1.tex

Применяя преобразование Фурье только для старших бит $\hat{F}^{\frac{M}{2}}$,
т. е. исключая $a^{(k)}_0$, получим (см. \autoref{figQuantCompQuantFourier1}):
\begin{eqnarray}
\ket{x} \rightarrow
\hat{F}^{\frac{M}{2}} \sum_{m = 0}^{\frac{M}{2} - 1}x_{2m} \ket{2m} +
\hat{F}^{\frac{M}{2}} \sum_{m = 0}^{\frac{M}{2} - 1}x_{2m + 1}
\ket{2m+1} = 
\nonumber \\
=
\hat{F}^{\frac{M}{2}} \sum_{m = 0}^{\frac{M}{2} - 1}x_{2m} 
\ket{0} \otimes  \ket{m} +
\hat{F}^{\frac{M}{2}} \sum_{m = 0}^{\frac{M}{2} - 1}x_{2m + 1}
\ket{1} \otimes  \ket{m}
=
\nonumber \\
=
\sum_{m = 0}^{\frac{M}{2} - 1}x_{2m} 
\ket{0} \otimes \hat{F}^{\frac{M}{2}} \ket{m} +
\sum_{m = 0}^{\frac{M}{2} - 1}x_{2m + 1}
\ket{1} \otimes \hat{F}^{\frac{M}{2}} \ket{m}.
\label{eqPart4QuantCompShorQuantFourierStep1}
\end{eqnarray}
С учетом выражения \eqref{eqPart4QuantCompShorQuantFourierBasis} получим
\begin{equation}
\hat{F}^{\frac{M}{2}} \ket{m} = \sqrt{\frac{2}{M}}
\sum_{j= 0}^{\frac{M}{2} - 1} e^{-i \frac{4 \pi}{M} m j}\ket{j}_{inv}.
\nonumber
\end{equation}
Таким образом для \eqref{eqPart4QuantCompShorQuantFourierStep1} имеем
\begin{eqnarray}
\ket{x} \rightarrow
\sum_{m = 0}^{\frac{M}{2} - 1}x_{2m} 
\ket{0} \otimes \hat{F}^{\frac{M}{2}} \ket{m} +
\sum_{m = 0}^{\frac{M}{2} - 1}x_{2m + 1}
\ket{1} \otimes \hat{F}^{\frac{M}{2}} \ket{m} = 
\nonumber \\
=
\sqrt{\frac{2}{M}} \sum_{j = 0}^{\frac{M}{2} - 1} e^{-i \frac{4 \pi}{M} m j} 
\sum_{m = 0}^{\frac{M}{2} - 1}x_{2m} \ket{0} \otimes
\ket{j}_{inv}
+
\nonumber \\
+
\sqrt{\frac{2}{M}} \sum_{j = 0}^{\frac{M}{2} - 1} e^{-i \frac{4 \pi}{M} m j} 
\sum_{m = 0}^{\frac{M}{2} - 1}x_{2m+1} \ket{1} \otimes
\ket{j}_{inv}
=
\nonumber \\
=
\sum_{j = 0}^{\frac{M}{2} - 1}  
\left( \sqrt{\frac{2}{M}} 
\sum_{m = 0}^{\frac{M}{2} - 1} e^{-i \frac{4 \pi}{M} m j} x_{2m} 
\right) \ket{j}_{inv}
+
\nonumber \\
+
\sum_{j = 0}^{\frac{M}{2} - 1}
\left( \sqrt{\frac{2}{M}}  
\sum_{m = 0}^{\frac{M}{2} - 1}e^{-i \frac{4 \pi}{M} m j} x_{2m+1} 
\right)
\left|\frac{M}{2} + j\right>_{inv}
=
\nonumber \\
= \sum^{\frac{M}{2} - 1}_{j = 0}  \tilde{A}_{j} \ket{j}_{inv} +
\sum^{\frac{M}{2} - 1}_{j = 0}  \tilde{B}_{j} \left|\frac{M}{2} + j\right>_{inv},
\nonumber
\end{eqnarray}
где
\begin{eqnarray}
\tilde{A}_{j} = 
\sqrt{\frac{2}{M}} 
\sum_{m = 0}^{\frac{M}{2} - 1} e^{-i \frac{4 \pi}{M} m j} x_{2m} 
\nonumber \\
\tilde{B}_{j} =
\sqrt{\frac{2}{M}} 
\sum_{m = 0}^{\frac{M}{2} - 1} e^{-i \frac{4 \pi}{M} m j} x_{2m+1} 
\label{eqPart4QuantCompShorAB}
\end{eqnarray}

\input ./part4/quantcomp/figquantfourier2.tex

Если добавить теперь фазовый сдвиг для нечетных элементов, т. е. для
тех у которых $a_0^k = 1$ то получим схему изображенную на
\autoref{figQuantCompQuantFourier2}: 
\begin{eqnarray}
\ket{x} \rightarrow
\hat{F}^{\frac{M}{2}} \sum_{m = 0}^{\frac{M}{2} - 1}x_{2m} \ket{2m} +
\hat{R}\hat{F}^{\frac{M}{2}} \sum_{m = 0}^{\frac{M}{2} - 1} x_{2m + 1}
\ket{2m+1} =
\nonumber \\
= 
\sum^{\frac{M}{2} - 1}_{j = 0} \tilde{A}_{j} \ket{j}_{inv} +
\sum^{\frac{M}{2} - 1}_{j = 0}  
\tilde{B}_{j} \hat{R}\left|\frac{M}{2} + j\right>_{inv},
\nonumber \\
= 
\sum^{\frac{M}{2} - 1}_{j = 0}  \tilde{A}_{j} \ket{j}_{inv} +
\sum^{\frac{M}{2} - 1}_{j = 0}  
\tilde{C}_{j} \left|\frac{M}{2} + j\right>_{inv}.
\label{eqPart4QuantCompShorFourierStep2}
\end{eqnarray}
Воспользовавшись выражением
\begin{equation}
\hat{R}_l \ket{b^{(j)}_l} = 
exp{\left(- 2 \pi i \frac{b^{(j)}_l}{2^{n-l}}\right)}
\ket{b^{(j)}_l}
\nonumber
\end{equation}
получим, что оператор $\hat{R}$ действует на состояние 
$\left|\frac{M}{2} + j\right>_{inv}$ следующим образом:
\begin{eqnarray}
\hat{R}\left|\frac{M}{2} + j\right>_{inv} = 
\hat{R}\ket{1} \otimes  \ket{j}_{inv} = 
\nonumber \\
= 
\ket{1} \otimes \hat{R}_0 \ket{b^{(j)}_0}
\otimes \cdots \otimes \hat{R}_{n-2} \ket{b^{(j)}_{n-2}} = 
\nonumber \\
= 
\prod_{l = 0}^{n-2}exp{\left(- 2 \pi i \frac{2^lb^{(j)}_l}{2^n}\right)}
\ket{1} \otimes \ket{j}_{inv} = 
\nonumber \\
=
exp{\left(-2 \pi i \frac{j}{M}\right)}
\left|\frac{M}{2} + j\right>_{inv} 
\label{eqPart4QuantCompShorFourierStep2Pre}
\end{eqnarray}
При выводе \eqref{eqPart4QuantCompShorFourierStep2Pre} было учтено,
что $j = b^{(j)}_0 + 2^1 b^{(j)}_1 + \dots + 2^{n-2} b^{(j)}_{n-2}$. 

Таким образом для $\tilde{C}_{j}$ в 
\eqref{eqPart4QuantCompShorFourierStep2} имеем
\begin{eqnarray}
\tilde{C}_{j} = 
\sqrt{\frac{2}{M}} 
\sum_{m = 0}^{\frac{M}{2} - 1} 
e^{- 2 \pi i \frac{j}{M}}
e^{-i \frac{4 \pi}{M} m j} x_{2m+1} =
\nonumber \\
=
\sqrt{\frac{2}{M}} 
\sum_{m = 0}^{\frac{M}{2} - 1} 
e^{-i \frac{2 \pi}{M} \left(2m+1\right) j} x_{2m+1}
\label{eqPart4QuantCompShorC}
\end{eqnarray}

\input ./part4/quantcomp/figquantfourier.tex

Если теперь применить преобразование Адамара для кубита
$\ket{a_0}$, то получим схему изображенную на
\autoref{figQuantCompQuantFourier}. При этом исходное состояние
преобразуется по следующему закону:
\begin{eqnarray}
\ket{x} \rightarrow
\hat{H}_0\hat{F}^{\frac{M}{2}} \sum_{m = 0}^{\frac{M}{2} - 1}x_{2m} \ket{2m} +
\hat{H}_0\hat{R}\hat{F}^{\frac{M}{2}}\sum_{m = 0}^{\frac{M}{2} - 1} x_{2m + 1} =
\nonumber \\
=
\sum_{j = 0}^{\frac{M}{2} - 1}
\tilde{A}_{j}
\hat{H}\ket{0} \otimes \ket{j}_{inv}
+
\sum_{j = 0}^{\frac{M}{2} - 1} 
\tilde{C}_{j}
\hat{H}\ket{1} \otimes \ket{j}_{inv} 
=
\nonumber \\
= 
\frac{1}{\sqrt{2}}\sum_{j = 0}^{\frac{M}{2} - 1}
\tilde{A}_{j} 
\left(\ket{0} + \ket{1} \right) \otimes  
\ket{j}_{inv}
+
\frac{1}{\sqrt{2}}\sum_{j = 0}^{\frac{M}{2} - 1}
\tilde{C}_{j} 
\left(\ket{0} - \ket{1} \right) \otimes  
\ket{j}_{inv}
=
\nonumber \\
=
\sum_{j = 0}^{\frac{M}{2} - 1}
\frac{\tilde{A}_{j} + \tilde{C}_{j} }{\sqrt{2}} 
\ket{0} \otimes \ket{j}_{inv} +
\sum_{j = 0}^{\frac{M}{2} - 1}
\frac{ \tilde{A}_{j} - \tilde{C}_{j}}{\sqrt{2}} 
\ket{1} \otimes \ket{j}_{inv}
=
\nonumber \\
=
\sum_{j = 0}^{\frac{M}{2} - 1}
\frac{\tilde{A}_{j} + \tilde{C}_{j} }{\sqrt{2}} \ket{j}_{inv} +
\sum_{j = 0}^{\frac{M}{2} - 1}
\frac{ \tilde{A}_{j} - \tilde{C}_{j}}{\sqrt{2}} 
\left|\frac{M}{2} + j \right>_{inv}.
\label{eqPart4QuantCompShorFourierStep3}
\end{eqnarray}
Для членов \eqref{eqPart4QuantCompShorFourierStep3} с учетом равенств
\eqref{eqPart4QuantCompShorAB} и \eqref{eqPart4QuantCompShorC} имеем:
\begin{eqnarray}
\frac{\tilde{A}_{j} + \tilde{C}_{j} }{\sqrt{2}} = 
\sqrt{\frac{1}{M}} 
\sum_{m = 0}^{\frac{M}{2} - 1} e^{-i \frac{4 \pi}{M} m j} x_{2m}  +
\sqrt{\frac{1}{M}} 
\sum_{m = 0}^{\frac{M}{2} - 1} 
e^{-i \frac{2 \pi}{M} \left(2m+1\right) j} x_{2m+1} = 
\nonumber \\
=
\sqrt{\frac{1}{M}} \sum_{m = 0}^{M - 1}
e^{-i \frac{2 \pi}{M} m j} x_{m}
\label{eqPart4QuantCompShorFourierStep3_1}
\end{eqnarray}
и
\begin{eqnarray}
\frac{\tilde{A}_{j} - \tilde{C}_{j} }{\sqrt{2}} = 
\sqrt{\frac{1}{M}} 
\sum_{m = 0}^{\frac{M}{2} - 1} e^{-i \frac{4 \pi}{M} m j} x_{2m}  -
\sqrt{\frac{1}{M}} 
\sum_{m = 0}^{\frac{M}{2} - 1} 
e^{-i \frac{2 \pi}{M} \left(2m+1\right) j} x_{2m+1}
= 
\nonumber \\
=
\sqrt{\frac{1}{M}} \sum_{m = 0}^{M - 1}
e^{-i \frac{2 \pi}{M} m j} x_{m} \frac{1 + e^{-i \pi m}}{2}
-
\sqrt{\frac{1}{M}} \sum_{m = 0}^{M - 1}
e^{-i \frac{2 \pi}{M} m j} x_{m} \frac{1 - e^{-i \pi m}}{2} 
=
\nonumber \\
=
\sqrt{\frac{1}{M}} \sum_{m = 0}^{M - 1}
e^{-i \frac{2 \pi}{M} m j} e^{-i \pi m } x_{m} 
=
\sqrt{\frac{1}{M}} \sum_{m = 0}^{M - 1}
e^{-i \frac{2 \pi}{M} m j} e^{-i \frac{2 \pi}{M} m \frac{M}{2} } x_{m} 
=
\nonumber \\
=
\sqrt{\frac{1}{M}} \sum_{m = 0}^{M - 1}
e^{-i \frac{2 \pi}{M} m \left(\frac{M}{2} + j\right)} x_{m}
\label{eqPart4QuantCompShorFourierStep3_2}
\end{eqnarray}

Объединяя \eqref{eqPart4QuantCompShorFourierStep3}, 
\eqref{eqPart4QuantCompShorFourierStep3_1} и
\eqref{eqPart4QuantCompShorFourierStep3_2} окончательно получим 
\begin{eqnarray}
\ket{x} \rightarrow
\sum_{j = 0}^{\frac{M}{2} - 1} \sqrt{\frac{1}{M}} \sum_{m = 0}^{M - 1}
e^{-i \frac{2 \pi}{M} m j} x_{m} \ket{j}_{inv} +
\nonumber \\
+
\sum_{j = 0}^{\frac{M}{2} - 1} \sqrt{\frac{1}{M}} \sum_{m = 0}^{M - 1}
e^{-i \frac{2 \pi}{M} m \left(\frac{M}{2} + j\right)} x_{m} 
\left|\frac{M}{2} + j\right>_{inv} =
\nonumber \\
= \sum_{j = 0}^{M - 1} \tilde{X}_j^{M} \ket{j}_{inv}
\nonumber
\end{eqnarray}
