%% -*- coding:utf-8 -*-
\section{Алгоритм ECDH}

\rindex{Алгоритм ECDH}
Алгоритм ECDH является модификацией алгоритма Диффи-Хеллмана (см.
\autoref{sec:add:dm:dh}) для эллиптических кривых. Протокол
Диффи-Хеллмана является протоколом обмена ключей. В нашем случае
публикуются следующие параметры эллиптической кривой:
$(p,a,b,g,n,h)$, где $p,a,b$ задают кривую 
\[
E\left(\mathbb{F}_p\right) = \{(x,y): y^2 \equiv x^3 +a x + b \mod p
\} \cup \{0\},
\]
$g$ - базовая точка порядка $n$: $\left|\left<g\right>\right| = n$,
$h$ - кофактор группы $\left<g\right>$, т.е. $\left|\right| = nh$.

Алиса выбирает закрытый ключ $d_a \in \{1, \dots, n - 1\}$ и формирует
открытый ключ $A = d_a g$. Боб также формирует закрытый $d_b \in
\{1, \dots, n - 1\}$ и открытый $B = d_b g$ ключи. Алиса и Боб
обмениваются этими ключами. Далее каждый из них вычисляет реальный
ключ по правилу $K = d_a B = d_b A$. 

%% *Elliptic> c = Curve (-7) 10 97
%% *Elliptic> p = Point 96 93 c
%% *Elliptic> pord p
%% 41
%% *Elliptic> cord c
%% 82
%% *Elliptic> da = 5
%% *Elliptic> a = da .*. p
%% *Elliptic> a
%% (37,35)
%% *Elliptic> b = 15
%% *Elliptic> db = 15
%% *Elliptic> b = db .*. p
%% *Elliptic> b
%% (15,51)
%% *Elliptic> da .*. b
%% (46,11)
%% *Elliptic> db .*. a
%% (46,11)
%% *Elliptic> 

\begin{example}[Алгоритм ECDH]
\label{ex:add:discretmath:ecdh}
Возьмем кривую и базовую точку из прим.
\ref{ex:add:elliptic:basepoint}. Т.о. 
\[
(p,a,b,g,n,h) = (97, -7, 10, (96,93), 41, 2)
\]
Алиса выбирает $d_a = 5$, т.е. 
$A = (37, 35)$. Боб выбирает $d_b = 15$, т.о. $B = (15,51)$. Ключ у
Алисы $K = d_a B = (46,11)$ и ключ у Боба $K = d_b A = (46,11)$
совпадают. 
\end{example}
